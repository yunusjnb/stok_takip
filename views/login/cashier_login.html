<!DOCTYPE html>
<html class="light" lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Yazar Kasa Girişi</title>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;700;900&amp;display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#42d411",
              "background-light": "#f6f8f6",
              "background-dark": "#152210",
            },
            fontFamily: {
              display: ["Work Sans", "Noto Sans", "sans-serif"],
            },
            borderRadius: {
              DEFAULT: "0.25rem",
              lg: "0.5rem",
              xl: "0.75rem",
              full: "9999px",
            },
          },
        },
      };
    </script>
    <style>
      .material-symbols-outlined {
        font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
        font-size: 24px;
      }
    </style>
  </head>
  <body class="bg-background-light dark:bg-background-dark font-display">
    <div
      class="relative flex min-h-screen w-full flex-col items-center justify-center bg-[#f9fcf8] dark:bg-background-dark p-4"
    >
      <div class="w-full max-w-md">
        <div class="mb-8 text-center">
          <h1
            class="text-4xl font-black leading-tight tracking-[-0.033em] text-[#111b0d] dark:text-background-light"
          >
            Yazar Kasa Girişi
          </h1>
          <p
            class="mt-2 text-base font-normal leading-normal text-[#5f9a4c] dark:text-primary/70"
          >
            Kasa işlemlerini başlatmak için giriş yapın.
          </p>
        </div>
        <div class="flex flex-col gap-6">
          <div class="flex flex-col">
            <label
              class="pb-2 text-base font-medium leading-normal text-[#111b0d] dark:text-background-light/90"
              for="username"
              >Kullanıcı Adı</label
            >
            <div class="relative flex w-full items-stretch">
              <input
                class="form-input h-14 flex-1 resize-none overflow-hidden rounded-lg border border-[#d5e7cf] bg-[#f9fcf8] p-4 pr-12 text-base font-normal leading-normal text-[#111b0d] placeholder:text-[#5f9a4c] focus:border-[#42d411] focus:outline-0 focus:ring-2 focus:ring-[#42d411]/30 dark:border-[#5f9a4c]/50 dark:bg-[#152210] dark:text-background-light dark:placeholder:text-primary/50 dark:focus:border-primary"
                id="username"
                placeholder="Kullanıcı adınızı girin"
                type="text"
              />
              <div
                class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-4 text-[#5f9a4c] dark:text-primary/70"
              >
                <span class="material-symbols-outlined">person</span>
              </div>
            </div>
          </div>
          <div class="flex flex-col">
            <label
              class="pb-2 text-base font-medium leading-normal text-[#111b0d] dark:text-background-light/90"
              for="password"
              >Şifre</label
            >
            <div class="relative flex w-full items-stretch">
              <input
                class="form-input h-14 flex-1 resize-none overflow-hidden rounded-lg border border-[#d5e7cf] bg-[#f9fcf8] p-4 pr-12 text-base font-normal leading-normal text-[#111b0d] placeholder:text-[#5f9a4c] focus:border-[#42d411] focus:outline-0 focus:ring-2 focus:ring-[#42d411]/30 dark:border-[#5f9a4c]/50 dark:bg-[#152210] dark:text-background-light dark:placeholder:text-primary/50 dark:focus:border-primary"
                id="password"
                placeholder="Şifrenizi girin"
                type="password"
              />
              <div
                class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-4 text-[#5f9a4c] dark:text-primary/70"
              >
                <span class="material-symbols-outlined">lock</span>
              </div>
            </div>
          </div>
          <button
            id="cashierLoginBtn"
            class="flex h-12 w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg bg-primary text-base font-bold leading-normal tracking-[0.015em] text-[#111b0d] transition-colors hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 focus:ring-offset-background-light dark:focus:ring-offset-background-dark"
          >
            <span class="truncate">Giriş Yap</span>
          </button>
        </div>
      </div>
      <div class="absolute bottom-5 text-center">
        <p
          class="text-sm font-normal leading-normal text-[#5f9a4c] dark:text-primary/60"
        >
          © 2025 Keşiş Kafe Yönetim Sistemi
        </p>
      </div>
    </div>
    <script>
      document
        .getElementById("cashierLoginBtn")
        .addEventListener("click", async () => {
          const username = document.getElementById("username").value.trim();
          const password = document.getElementById("password").value;

          if (!username || !password) {
            alert("Kullanıcı adı ve şifre gerekli");
            return;
          }

          try {
            const response = await fetch("/api/auth/login", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ username, password }),
            });

            const data = await response.json();

            if (!response.ok) {
              alert(data.error || "Giriş başarısız");
              return;
            }

            if (data.admin?.type !== "kasa") {
              alert("Bu ekrana sadece kasa kullanıcıları girebilir");
              return;
            }

            localStorage.setItem("username", data.admin.username);
            localStorage.setItem("userType", data.admin.type);
            window.location.href = "/cashier/cart";
          } catch (error) {
            console.error("Cashier login error:", error);
            alert("Bir hata oluştu");
          }
        });
    </script>
  </body>
</html>
